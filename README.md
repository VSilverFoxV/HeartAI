# Прогноз риска сердечного приступа

Проект содержит нейронную сеть для прогноза риска сердечного приступа на основе медицинских данных пациентов.

## Структура проекта

- `heart_neural_network/` - основной модуль для обучения и прогноза
  - `train_model.py` - скрипт для обучения модели
  - `predict_model.py` - скрипт для предсказания
  - `heart_disease_model.joblib` - обученная модель
  - `heart.csv` - набор данных для обучения

- `website/` - веб-интерфейс для работы с моделью
  - `app.py` - Flask-приложение
  - `templates/` - HTML-шаблоны
  - `static/` - статические файлы (CSS, JS)

- `docs/` - документация проекта
  - `source/` - исходные файлы документации
  - `build/` - сгенерированная документация

## Зависимости

Для работы проекта на Python 3.8+ требуются следующие библиотеки:

- NumPy
- Pandas
- Scikit-learn
- TensorFlow
- Flask
- Joblib
- Matplotlib
- Seaborn
- setuptools (для установки через pip)

Для установки всех зависимостей выполните:

```bash
pip install -r requirements.txt
```

## Установка

Для установки пакета выполните:

```bash
pip install -e .
```

## Использование

### Обучение модели
```python
from heart_neural_network.train_model import train
train()
```

### Предсказание
```python
from heart_neural_network.predict_model import predict
result = predict(data)
```

### Запуск веб-интерфейса
```bash
python -m website.app
```

## Документация

Для сборки документации вам потребуются дополнительные зависимости:

```bash
pip install -e ".[docs]"
```

Сборка HTML-документации:

```bash
python -m sphinx.cmd.build -b html docs/source docs/build/html
```

После сборки документация будет доступна в директории `docs/build/html`. 

# Инструкция по запуску приложения в Docker

## Структура
Приложение упаковано в Docker-контейнер для обеспечения надежной работы. Основной принцип - веб-приложение запускается в контейнере, а модель машинного обучения монтируется из хост-системы. Это позволяет:
1. Переобучать модель на хост-системе, используя все доступные ресурсы
2. Предоставлять веб-интерфейс для предсказаний через контейнер
3. Автоматический перезапуск контейнера в случае сбоя

## Как запустить
1. Убедитесь, что у вас установлены Docker и Docker Compose
2. Из корневой директории проекта запустите:
```
docker-compose up -d
```
3. Приложение будет доступно по адресу: `http://localhost:8000`

## Переменные окружения
- `MODEL_PATH` - путь к файлу модели (по умолчанию: `/app/heart_neural_network/heart_disease_model.joblib`)

## Обновление модели
При переобучении модели на хост-системе, контейнер автоматически получит доступ к новой версии модели через монтирование тома.

Для переобучения модели используйте скрипт `heart_neural_network/train_model.py` непосредственно на хост-системе:
```
python heart_neural_network/train_model.py
```

## Масштабирование
При необходимости масштабирования сервиса, вы можете:
```
docker-compose up -d --scale web=3
```
Однако в этом случае потребуется настройка балансировщика нагрузки. 